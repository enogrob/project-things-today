test_01_tdpn_should_print_error_bad_argument() {
    source ~/.todayrc
    assert_equals "Error: Bad number of arguments!" "$(things projects new)"
}

test_02_tdpn_should_return_status_code_1() {
    source ~/.todayrc
    things projects new > /dev/null
    assert_equals $? 1 
}

test_03_tdpn_should_create_dir_in_Projects() {
    source ~/.todayrc
    if [ -d "$PROJECTS/learning-nodejs" ]; then rm -Rf $PROJECTS/learning-nodejs; fi
        
    things projects new learning-nodejs > /dev/null
    assert "test -d $PROJECTS/$PROJECT"
}

test_04_tdpn_should_create_project_project_type_vars() {
    source ~/.todayrc
    if [ -d "$PROJECTS/learning-nodejs" ]; then rm -Rf $PROJECTS/learning-nodejs; fi
        
    things projects new learning-nodejs > /dev/null
    assert_equals "learning-nodejs" $PROJECT
    assert_equals "project" $PROJECT_TYPE
}

test_05_tdpn_should_create_project_tag() {
    source ~/.todayrc
    if [ -d "$PROJECTS/learning-nodejs" ]; then rm -Rf $PROJECTS/learning-nodejs; fi
        
    things projects new learning-nodejs > /dev/null
    assert_equals "/Users/enogrob/Things/Projects/learning-nodejs	project" "$(tag -l $PROJECTS/$PROJECT)" 
}

test_06_tdpn_should_create_project_tag_specialization() {
    source ~/.todayrc
    if [ -d "$PROJECTS/learning-nodejs" ]; then rm -Rf $PROJECTS/learning-nodejs; fi
        
    things projects new learning-nodejs specialization > /dev/null
    assert_equals "/Users/enogrob/Things/Projects/learning-nodejs	specialization" "$(tag -l $PROJECTS/$PROJECT)" 
}

test_07_tdpn_should_create_project_icon() {
    source ~/.todayrc
    if [ -d "$PROJECTS/learning-nodejs" ]; then rm -Rf $PROJECTS/learning-nodejs; fi
        
    things projects new learning-nodejs > /dev/null
    assert "test -f $PROJECTS/$PROJECT/Icon?"
}

test_08_tdpn_should_print_error_bad_project_type() {
    source ~/.todayrc
    if [ -d "$PROJECTS/learning-nodejs" ]; then rm -Rf $PROJECTS/learning-nodejs; fi
        
    assert_equals "Error: Bad project type!" "$(things projects new learning-nodejs xxxx)"
}

test_09_tdpn_should_return_status_code_1_for_bad_project_type() {
    source ~/.todayrc
    if [ -d "$PROJECTS/learning-nodejs" ]; then rm -Rf $PROJECTS/learning-nodejs; fi
    
    things projects new learning-nodejs xxxx > /dev/null
    assert_equals $? 1 
}

test_10_tdpi_should_create_link_in_Today() {
    source ~/.todayrc
    if [ -d "$PROJECTS/learning-nodejs" ]; then rm -Rf $PROJECTS/learning-nodejs; fi
    if [ -L "$TODAY/learning-nodejs" ]; then rm -f $TODAY/learning-nodejs; fi
    
    things projects new learning-nodejs > /dev/null
    things projects start > /dev/null
    assert "test -L $TODAY/$PROJECT"
}

test_11_tdpe_should_remove_link_in_Today() {
    source ~/.todayrc
    if [ -d "$PROJECTS/learning-nodejs" ]; then rm -Rf $PROJECTS/learning-nodejs; fi
    if [ -f "$TODAY/learning-nodejs" ]; then rm -f $TODAY/learning-nodejs; fi
    
    things projects new learning-nodejs > /dev/null
    things projects start > /dev/null
    things projects stop > /dev/null
    assert "! test -f $TODAY/$PROJECT"
}

# Change to directory where bash_unit so
# that we can use our scripts under test
# more easily

cd $(dirname $0)